---
layout: events
title: Events - StartupOulu
---
{% assign now = 'now' | date: '%s' | plus: 0 %}
{% assign future_events = '' | split: '' %}

{% for event in site.events %}
  {% assign event_time = event.start_time | date: '%s' | plus: 0 %}
  {% if event_time >= now %}
    {% assign future_events = future_events | push: event %}
  {% endif %}
{% endfor %}

{% assign sorted_future_events = future_events | sort: 'start_time' %}

    <div class="r2a_container">
        <div class="flex justify-end mb-6">
            <button id="toggle-view" class="calendar-toggle-btn"> 
                Switch to Calendar View 
            </button>
        </div>
    </div>

    <!--  event section start -->
    <section class="event_section">

        <div id="list-view">
            <div class="r2a_container">
                <div class="event_wrapper events-grid">
                  {% for event in sorted_future_events %}
                      {% include events/card.html %}
                  {% endfor %}
                </div>
            </div>      
        </div>

        <div id="calendar-view" style="display:none;">
            <div class="r2a_container">
                <div id="calendar"></div>
            </div>
        </div>
        <!--
        <div class="flex justify-center">
          <a href="#" class="show_event_btn flex items-center flex-col gap-20">
            LOAD MORE EVENTS
            <div class="underline"></div>
          </a>
        </div>
        -->
    </section>

{% assign all_events = site.events | sort: 'start_time' %}

<!-- full calendar -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<!-- calendar js -->
<script> 
    const toggleBtn = document.getElementById('toggle-view')
    const listView = document.getElementById('list-view')
    const calendarView = document.getElementById('calendar-view')

    let calendarInitialized = false;
    
    toggleBtn.onclick = () => {
        const showingList = listView.style.display !== 'none'

        if (showingList) {
            listView.style.display = 'none'
            calendarView.style.display = 'block'
            toggleBtn.textContent = "Switch to List View"


            if (!calendarInitialized) {
                const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
                    initialView: 'dayGridMonth',
                    titleFormat: { year: 'numeric', month: 'long' },
                    timeZone: 'Europe/Helsinki',
                    firstDay: 1,
                    eventTimeFormat: {
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: false
                    },
                    events: [
                        {% for event in all_events %}
                        {% assign start_ts = event.start_time | date: "%s" %}
                        {% assign end_ts   = event.end_time   | date: "%s" %}
                        {% assign duration_seconds = end_ts | minus: start_ts %}
                        {% assign duration_days = duration_seconds | divided_by: 86400 %}
                        {
                            title: {{ event.title | jsonify}},
                            start: "{{ event.start_time | date: '%Y-%m-%dT%H:%M:%S' }}",

                            {% if duration_days < 7 %}
                                end: "{{ event.end_time   | date: '%Y-%m-%dT%H:%M:%S' }}",
                            {% endif %}

                            allDay: false,
                            url: "{{ event.url }}"
                        }{% unless forloop.last %},{% endunless %}
                        {% endfor %}
                    ]                    
                })
                calendar.render()
                calendarInitialized = true
            }
        
        } else {
        calendarView.style.display = 'none'
        listView.style.display = 'block'
        toggleBtn.textContent = "Switch to Calendar View"
        } 
    }
</script>